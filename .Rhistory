library(ggplot2)
PATH <- getwd()
setwd(PATH)
getwd()
SRR064545 <- read.table("final_data/SRR064545.vep.output.txt",
header = TRUE,
sep = "\t")
View(SRR064545)
SRR064545 <- read.table("final_data/SRR064545.vep.output.txt",
header = FALSE,
sep = "\t")
View(SRR064545)
SRR064546 <- read.table("final_data/SRR064546.vep.output.txt",
header = FALSE,
sep = "\t")
SRR064547 <- read.table("final_data/SRR064547.vep.output.txt",
header = FALSE,
sep = "\t")
PATH <- getwd()
setwd(PATH)
SRR064545 <- read.table("final_data/vep_output/SRR064545.vep.txt",
header = TRUE,
sep = "\t")
View(SRR064545)
SRR064545 <- read.table("final_data/vep_output/SRR064545.vep.txt",
header = TRUE,
sep = "\t")
View(SRR064545)
SRR064546 <- read.table("final_data/SRR064546.vep.output.txt",
header = FALSE,
sep = "\t")
SRR064547 <- read.table("final_data/SRR064547.vep.output.txt",
header = FALSE,
sep = "\t")
SRR064546 <- read.table("final_data/vep_output/SRR064546.vep.txt",
header = TRUE,
sep = "\t")
SRR064547 <- read.table("final_data/vep_output/SRR064547.vep.txt",
header = FALSE,
sep = "\t")
SRR064545.vcf <- read.table("final_data/SRR064545.final.vcf")
View(SRR064545.vcf)
library(ggplot2)
ggplot(SRR064545.vcf, aes(x = chr)) + geom_col()
colnames(SRR064545.vcf) <- c("CHROM",
"POS",
"ID",
"REF",
"ALT",
"QUAL",
"FILTER",
"INFO",
"FORMAT")
colnames(SRR064545.vcf) <- c("CHROM",
"POS",
"ID",
"REF",
"ALT",
"QUAL",
"FILTER",
"INFO",
"FORMAT",
"FILE")
ggplot(SRR064545.vcf, aes(x = CHROM)) + geom_col()
ggplot(SRR064545.vcf, aes(x = CHROM)) + geom_bar(stat = 'identity')
ggplot(SRR064545.vcf, aes(x = CHROM)) + geom_bar(stat = 'counts')
ggplot(SRR064545.vcf, aes(x = CHROM)) + geom_bar(stat = 'count')
SRR064546.vcf <- read.table("final_data/SRR064545.final.vcf")
colnames(SRR064546.vcf) <- c("CHROM",
"POS",
"ID",
"REF",
"ALT",
"QUAL",
"FILTER",
"INFO",
"FORMAT",
"FILE")
SRR064547.vcf <- read.table("final_data/SRR064545.final.vcf")
colnames(SRR064547.vcf) <- c("CHROM",
"POS",
"ID",
"REF",
"ALT",
"QUAL",
"FILTER",
"INFO",
"FORMAT",
"FILE")
ggplot(SRR064546.vcf, aes(x = CHROM)) + geom_bar(stat = 'count')
setwd("C:/Users/Bartlomiej/Desktop/AnalizaDanychNGS")
SRR064545.vep <- read.table("final_data/vep_output/SRR064545.vep.txt",
header = TRUE,
sep = "\t")
SRR064546.vep <- read.table("final_data/vep_output/SRR064546.vep.txt",
header = TRUE,
sep = "\t")
SRR064547.vep <- read.table("final_data/vep_output/SRR064547.vep.txt",
header = FALSE,
sep = "\t")
library(ggplot2)
View(SRR064545.vep)
library(purrr)
SRR064545.vep$Chrom <- unlist(map(strsplit(SRR064545.vep$Uploaded_variation, "_"), 1))
SRR064546.vep$Chrom <- unlist(map(strsplit(SRR064546.vep$Uploaded_variation, "_"), 1))
SRR064547.vep$Chrom <- unlist(map(strsplit(SRR064547.vep$Uploaded_variation, "_"), 1))
SRR064547.vep <- read.table("final_data/vep_output/SRR064547.vep.txt",
header = TRUE,
sep = "\t")
SRR064547.vep$Chrom <- unlist(map(strsplit(SRR064547.vep$Uploaded_variation, "_"), 1))
ggplot(SRR064545.vep, aes(x = Chrom)) + geom_bar(stat = 'count')
p1 <- ggplot(SRR064545.vep, aes(x = Chrom)) + geom_bar(stat = 'count')
p2 <- ggplot(SRR064546.vep, aes(x = Chrom)) + geom_bar(stat = 'count')
p3 <- ggplot(SRR064547.vep, aes(x = Chrom)) + geom_bar(stat = 'count')
library(grid)
library(gridExtra)
grid.arrange(p1, p2, p3, ncol = 3)
q1 <- ggplot(SRR064545.vep, aes(x = Chrom, color = Consequence)) + geom_point()
q1
q1 <- ggplot(SRR064545.vep, aes(x = Chrom, color = Consequence)) + geom_bar(stat = 'count')
q1
q1 <- ggplot(SRR064545.vep, aes(x = Chrom, color = Consequence)) + geom_bar(stat = 'fill')
q1
q1 <- ggplot(SRR064545.vep, aes(x = Chrom, fill = Consequence)) + geom_bar(stat = 'count')
q1
PATH <- getwd()
setwd(PATH)
install.packages("vcfR")
library(vcfR)
VCF.45 <- read.vcfR("final_data/SRR064545.final.vcf")
VCF.46 <- read.vcfR("final_data/SRR064546.final.vcf")
VCF.47 <- read.vcfR("final_data/SRR064547.final.vcf")
REFERENCE.GENOME <- ape::read.dna("data/reference_genome/Saccharomyces_cerevisiae.genome.fa.gz", format = "fasta")
REFERENCE.ANNOT <- read.table("data/reference_genome/Saccharomyces_cerevisiae.R64-1-1.106.gff3", sep = "\t")
View(REFERENCE.ANNOT)
library(ape)
REFERENCE.ANNOT <- read.gff("data/reference_genome/Saccharomyces_cerevisiae.R64-1-1.106.gff3", GFF3 = TRUE)
View(REFERENCE.ANNOT)
REFERENCE.ANNOT <- read.gff("data/reference_genome/Saccharomyces_cerevisiae.R64-1-1.106.gff3",na.strings = ".", GFF3 = TRUE)
REFERENCE.ANNOT <- read.gff("data/reference_genome/Saccharomyces_cerevisiae.R64-1-1.106.gff3",na.strings = c(".", "?"), GFF3 = TRUE)
?create.chromR
View(VCF.45)
make.chrom.obj <- function(vcf.object, name, ref.genome, ref.annot){
chrom <- create.chromR(vcf = vcf.object,
name = name,
seq = ref.genome,
ann = ref.annot)
return(chrom)
}
tmp.45 <- make.chrom.obj(vcf.object = VCF.45, name = "SAMPLE_45", ref.genome = REFERENCE.GENOME, ref.annot = REFERENCE.ANNOT)
View(REFERENCE.GENOME)
REFERENCE.GENOME <- read.dna("data/reference_genome/Saccharomyces.reference.genome.fa.gz", format = "fasta")
tmp.45 <- make.chrom.obj(vcf.object = VCF.45, name = "SAMPLE_45", ref.genome = REFERENCE.GENOME, ref.annot = REFERENCE.ANNOT)
plot(tmp.45)
chromqc(tmp.45)
chromoqc(tmp.45)
VCF.45 <- read.vcfR("final_data/SRR064545.final.vcf")
VCF.46 <- read.vcfR("final_data/SRR064546.final.vcf")
VCF.47 <- read.vcfR("final_data/SRR064547.final.vcf")
REFERENCE.GENOME <- read.dna("data/reference_genome/Saccharomyces.reference.genome.fa.gz", format = "fasta")
REFERENCE.ANNOT <- read.gff("data/reference_genome/Saccharomyces_cerevisiae.R64-1-1.106.gff3", na.strings = c(".", "?"), GFF3 = TRUE)
# ------------------------------------------------------------------------------
# For each sample plot chromosome
make.chrom.obj <- function(vcf.object, name, ref.genome, ref.annot){
chrom <- create.chromR(vcf = vcf.object,
name = name,
seq = ref.genome,
ann = ref.annot)
return(chrom)
}
SAMPLE.45 <- make.chrom.obj(vcf.object = VCF.45,
name = "SAMPLE 45",
ref.genome = REFERENCE.GENOME,
ref.annot = REFERENCE.ANNOT)
SAMPLE.46 <- make.chrom.obj(vcf.object = VCF.46,
name = "SAMPLE 47",
ref.genome = REFERENCE.GENOME,
ref.annot = REFERENCE.ANNOT)
SAMPLE.47 <- make.chrom.obj(vcf.object = VCF.47,
name = "SAMPLE 47",
ref.genome = REFERENCE.GENOME,
ref.annot = REFERENCE.ANNOT)
plot(SAMPLE.45)
plot(SAMPLE.46)
plot(SAMPLE.47)
chromoqc(SAMPLE.47)
chromoqc(SAMPLE.46)
chromoqc(SAMPLE.45)
plot.chrom <- plot(SAMPLE.45)
plot.chrom
plot(SAMPLE.45)
chromoqc(SAMPLE.45)
plot(SAMPLE.46)
chromoqc(SAMPLE.46)
plot(SAMPLE.47)
chromoqc(SAMPLE.47)
plot(SAMPLE.45)
chromoqc(SAMPLE.45)
plot(SAMPLE.46)
chromoqc(SAMPLE.46)
plot(SAMPLE.47)
chromoqc(SAMPLE.47)
chromoqc(SAMPLE.45, xlim=c(5e+05, 6e+05))
tmp.45 <- masker(SAMPLE.45, min_QUAL = 1, min_DP = 3, max_DP = 10000, min_MQ = 59.9,  max_MQ = 60.1)
tmp.45
plot(tmp.45)
tmp.45 <- masker(SAMPLE.45, min_QUAL = 1, min_DP = 3, max_DP = 10000, min_MQ = 20,  max_MQ = 60.1)
plot(tmp.45)
tmp.45 <- masker(SAMPLE.45, min_QUAL = 1, min_DP = 3, max_DP = 10000, min_MQ = 25,  max_MQ = 60.1)
plot(tmp.45)
tmp.45 <- masker(SAMPLE.45, min_QUAL = 10, min_DP = 3, max_DP = 10000, min_MQ = 25,  max_MQ = 60.1)
plot(tmp.45)
tmp.45 <- masker(SAMPLE.45, min_QUAL = 10, min_DP = 10, max_DP = 10000, min_MQ = 25,  max_MQ = 60.1)
plot(tmp.45)
tmp.45 <- masker(SAMPLE.45, min_QUAL = 10, min_DP = 5, max_DP = 10000, min_MQ = 25,  max_MQ = 60.1)
plot(tmp.45)
?proc.chromR
